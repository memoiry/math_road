(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41249,       1267]
NotebookOptionsPosition[     40310,       1230]
NotebookOutlinePosition[     40674,       1246]
CellTagsIndexPosition[     40631,       1243]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:6837\:6761\:63d2\:503c\:5f97\:5230\:7b49\:9ad8\:7ebf\:56fe\:ff0c\:68af\
\:5ea6\:5411\:91cf\:56fe", "Subchapter",
 CellChangeTimes->{3.719443385774269*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lati", ",", "longii"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"lati", ",", "40.990660", ",", "41.137997", ",", "0.00294674"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"longii", ",", 
       RowBox[{"-", "111.852795"}], ",", 
       RowBox[{"-", "111.779228"}], ",", "0.00147133"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"test", "=", 
    RowBox[{"Get", "[", "\"\<./elevation_data.wl\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "uncommand", " ", "the", " ", "following", " ", "line", " ", "if", " ", 
    "you", " ", "want", "  ", "to", " ", "download", " ", "the", " ", "data", 
    " ", "from", " ", "the", " ", "Internet"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"test", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"GeoElevationData", "[", 
        RowBox[{"temp", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "50"}], "}"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot3D", "[", 
  RowBox[{
   RowBox[{"QuantityArray", "[", "test", "]"}], ",", 
   RowBox[{"MeshFunctions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"#3", "&"}], "}"}]}], ",", 
   RowBox[{"Mesh", "\[Rule]", "30"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"algoX", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"algoY", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grad", "[", 
   RowBox[{"data_", ",", "algo_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], ";;", 
           RowBox[{"(", 
            RowBox[{"i", "+", "1"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], ";;", 
           RowBox[{"(", 
            RowBox[{"j", "+", "1"}], ")"}]}]}], "]"}], "]"}], "*", "algo"}], 
      ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "data", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "data", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradX1", "=", 
   RowBox[{"-", 
    RowBox[{"grad", "[", 
     RowBox[{
      RowBox[{"QuantityMagnitude", "[", "test", "]"}], ",", "algoX"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradY1", "=", 
   RowBox[{"-", 
    RowBox[{"grad", "[", 
     RowBox[{
      RowBox[{"QuantityMagnitude", "[", "test", "]"}], ",", "algoY"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim11", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "gradX1", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim21", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "gradX1", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListVectorPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gradX1", "[", 
       RowBox[{"[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}], ",", 
      RowBox[{"gradY1", "[", 
       RowBox[{"[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "1", ",", "dim21"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", "dim11"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7194431716563463`*^9, 3.719443209016683*^9}, {
  3.719443239619835*^9, 3.719443298365365*^9}, {3.719443378654086*^9, 
  3.7194433835487947`*^9}, {3.719546002542161*^9, 3.719546003322133*^9}, {
  3.7195460534019413`*^9, 3.719546061254015*^9}, {3.719546106780978*^9, 
  3.719546154964776*^9}, {3.7195463820699368`*^9, 3.719546407810066*^9}, {
  3.719546491465852*^9, 3.719546534706505*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\:83b7\:5f97\:7ea2\:8272\:5947\:5f02\:70b9\:4e0e\:7eff\:8272\:7279\:5f81\:70b9\
\:ff0c\:5e76\:7ed8\:5236\:5728\:7b49\:9ad8\:7ebf\:56fe\:4e0a\
\>", "Subchapter",
 CellChangeTimes->{{3.719443333039782*^9, 3.7194433520407667`*^9}, {
  3.71944348819733*^9, 3.7194434981770353`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"algoX", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"algoY", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grad", "[", 
   RowBox[{"data_", ",", "algo_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], ";;", 
           RowBox[{"(", 
            RowBox[{"i", "+", "1"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], ";;", 
           RowBox[{"(", 
            RowBox[{"j", "+", "1"}], ")"}]}]}], "]"}], "]"}], "*", "algo"}], 
      ",", "2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "data", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "data", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"threshold", "=", "700"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mapEigene", "[", "data_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", "i", ")"}], ",", 
               RowBox[{"(", "j", ")"}]}], "]"}], "]"}], "-", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", "i", ")"}], ",", 
               RowBox[{"(", 
                RowBox[{"j", "-", "1"}], ")"}]}], "]"}], "]"}]}], ")"}], "*", 
          
          RowBox[{"(", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", "i", ")"}], ",", 
               RowBox[{"(", 
                RowBox[{"j", "+", "1"}], ")"}]}], "]"}], "]"}], "-", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", "i", ")"}], ",", 
               RowBox[{"(", "j", ")"}]}], "]"}], "]"}]}], ")"}]}], ")"}], "<",
         "0"}], "||", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"(", "i", ")"}], ",", 
                RowBox[{"(", "j", ")"}]}], "]"}], "]"}], "-", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], ",", 
                RowBox[{"(", "j", ")"}]}], "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}], ",", 
                RowBox[{"(", "j", ")"}]}], "]"}], "]"}], "-", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"(", "i", ")"}], ",", 
                RowBox[{"(", "j", ")"}]}], "]"}], "]"}]}], ")"}]}], "<", 
          "0"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", "i", ")"}], ",", 
                 RowBox[{"(", "j", ")"}]}], "]"}], "]"}], "-", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", "i", ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "]"}], "]"}]}], ")"}], 
            "]"}], ">", "threshold"}], "||", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", "i", ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"j", "+", "1"}], ")"}]}], "]"}], "]"}], "-", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", "i", ")"}], ",", 
                 RowBox[{"(", "j", ")"}]}], "]"}], "]"}]}], ")"}], "]"}], ">",
            "threshold"}], "||", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", "i", ")"}], ",", 
                 RowBox[{"(", "j", ")"}]}], "]"}], "]"}], "-", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], ",", 
                 RowBox[{"(", "j", ")"}]}], "]"}], "]"}]}], ")"}], "]"}], ">",
            "threshold"}], "||", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}], ",", 
                 RowBox[{"(", "j", ")"}]}], "]"}], "]"}], "-", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", "i", ")"}], ",", 
                 RowBox[{"(", "j", ")"}]}], "]"}], "]"}]}], ")"}], "]"}], ">",
            "threshold"}]}], ")"}]}]}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "data", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "data", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigenres", "=", 
   RowBox[{"mapEigene", "[", 
    RowBox[{"QuantityMagnitude", "[", "test", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradX1", "=", 
   RowBox[{"-", 
    RowBox[{"grad", "[", 
     RowBox[{
      RowBox[{"QuantityMagnitude", "[", "test", "]"}], ",", "algoX"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradY1", "=", 
   RowBox[{"-", 
    RowBox[{"grad", "[", 
     RowBox[{
      RowBox[{"QuantityMagnitude", "[", "test", "]"}], ",", "algoY"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim11", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "gradX1", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim21", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "gradX1", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gradX1", "[", 
        RowBox[{"[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"gradY1", "[", 
         RowBox[{"[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}], "*", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "dim11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "1", ",", "dim21"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradAbs", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Abs", "/@", "gradTemp"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp11", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"gradAbs", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "1"}], ")"}], ";;", 
           RowBox[{"(", 
            RowBox[{"x", "+", "1"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", "1"}], ")"}], ";;", 
           RowBox[{"(", 
            RowBox[{"y", "+", "1"}], ")"}]}]}], "]"}], "]"}], ",", "2"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "2", ",", 
       RowBox[{"dim11", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "2", ",", 
       RowBox[{"dim21", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"histRes", "=", 
   RowBox[{"HistogramList", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "temp11", "]"}], ",", "100"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"temp11", ",", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "<", "7500"}], "&"}], ")"}]}]}], "]"}], "+", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posEigen", "=", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"eigenres", ",", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "True"}], "&"}], ")"}]}]}], "]"}], "+", 
    "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedPoint", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pos", "[", 
        RowBox[{"[", 
         RowBox[{"x", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"pos", "[", 
        RowBox[{"[", 
         RowBox[{"x", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"test", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"pos", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"pos", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "pos", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedEigen", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"posEigen", "[", 
        RowBox[{"[", 
         RowBox[{"x", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"posEigen", "[", 
        RowBox[{"[", 
         RowBox[{"x", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"test", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"posEigen", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"posEigen", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "posEigen", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot3D", "[", 
    RowBox[{
     RowBox[{"QuantityArray", "[", "test", "]"}], ",", 
     RowBox[{"MeshFunctions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"#3", "&"}], "}"}]}], ",", 
     RowBox[{"Mesh", "\[Rule]", "30"}]}], "]"}], ",", 
   RowBox[{"ListPointPlot3D", "[", 
    RowBox[{"selectedPoint", ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Green", ",", 
        RowBox[{"PointSize", "[", ".02", "]"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"ListPointPlot3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"33", ",", "36", ",", 
        TemplateBox[{"5833.333333333334`","\"ft\"","feet","\"Feet\""},
         "Quantity"]}], "}"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"PointSize", "[", "0.03", "]"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"ListPointPlot3D", "[", 
    RowBox[{"selectedEigen", ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"PointSize", "[", ".02", "]"}]}], "}"}]}]}], "]"}]}], 
  "]"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:521d\:6b65\:805a\:7c7b\:ff0c\:5e76\:7ed8\:5236\:56fe\:7247", \
"Subchapter",
 CellChangeTimes->{{3.719443398041542*^9, 3.7194433988357277`*^9}, {
  3.719443481607226*^9, 3.7194434843064003`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempselected", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"QuantityMagnitude", "@", 
        RowBox[{"UnitConvert", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "\"\<Meters\>\""}], "]"}]}]}],
       "}"}], "&"}], "/@", "selectedPoint"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
     RowBox[{"FindClusters", "[", 
      RowBox[{"tempselected", ",", "15", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<KMeans\>\""}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"PointSize", "[", "Medium", "]"}]}]}], "]"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:83b7\:53d616\:5bf9\:8fde\:7ebf\:4e4b\:95f4\:603b\:9053\:8def\:6570\
\:4e0e\:4e09\:79cd\:7ebf\:5206\:79cd\:7c7b\:9053\:8def\:6570", "Subchapter",
 CellChangeTimes->{{3.7194434262163887`*^9, 3.719443462480667*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MeanDist", "[", 
   RowBox[{"data_", ",", "x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tempres1", "}"}], ",", 
    RowBox[{
     RowBox[{"tempres1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"data", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<=", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}]}], "]"}]}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StandardDeviation", "[", "tempres1", "]"}], ">", 
        TemplateBox[{"400","\"ft\"","feet","\"Feet\""},
         "Quantity"]}], ",", "0", ",", 
       RowBox[{"Mean", "[", "tempres1", "]"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MeanPos", "[", 
   RowBox[{"data_", ",", "x_", ",", "y_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tempres1", "}"}], ",", 
    RowBox[{
     RowBox[{"tempres1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Select", "[", 
        RowBox[{"data", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<=", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}]}], "]"}]}]}], ";", 
     RowBox[{"Floor", "[", 
      RowBox[{"Mean", "[", "tempres1", "]"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PointList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10", ",", "14"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "18"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"16", ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "14"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "40"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"8", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "37"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"14", ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26", ",", "30"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"16", ",", "25"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "40"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44", ",", "48"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"21", ",", "24"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"25", ",", "32"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"16", ",", "25"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "56"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"28", ",", "32"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "20"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"34", ",", "35"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "16"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"30", ",", "33"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "22"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"28", ",", "31"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24", ",", "36"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meandist", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{"UnitConvert", "[", 
       RowBox[{"#", ",", "\"\<Meters\>\""}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"MeanDist", "[", 
       RowBox[{"selectedPoint", ",", 
        RowBox[{"PointList", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"PointList", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "13"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanpos", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MeanPos", "[", 
      RowBox[{"selectedPoint", ",", 
       RowBox[{"PointList", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"PointList", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "13"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relation", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "9"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relationPair", "=", 
   RowBox[{"{", 
    RowBox[{
    "5", ",", "10", ",", "3", ",", "8", ",", "11", ",", "6", ",", "7", ",", 
     "10", ",", "18", ",", "5", ",", "9", ",", "8", ",", "20", ",", "12", ",",
      "9", ",", "15"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lati", ",", "longii"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"lati", ",", "40.990660", ",", "41.137997", ",", "0.00294674"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"longii", ",", 
       RowBox[{"-", "111.852795"}], ",", 
       RowBox[{"-", "111.779228"}], ",", "0.00147133"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"meandist", "[", 
          RowBox[{"[", 
           RowBox[{"relation", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "-", 
         RowBox[{"meandist", "[", 
          RowBox[{"[", 
           RowBox[{"relation", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], "]"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"QuantityMagnitude", "[", 
          RowBox[{"UnitConvert", "[", 
           RowBox[{
            RowBox[{"GeoDistance", "[", 
             RowBox[{
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"meanpos", "[", 
                   RowBox[{"[", 
                    RowBox[{"relation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "[", 
                  
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"meanpos", "[", 
                   RowBox[{"[", 
                    RowBox[{"relation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "[", 
                  
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"meanpos", "[", 
                   RowBox[{"[", 
                    RowBox[{"relation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "[", 
                  
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"meanpos", "[", 
                   RowBox[{"[", 
                    RowBox[{"relation", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "[", 
                  
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
            ",", "\"\<Kilometers\>\""}], "]"}], "]"}], "*", "1000"}], ")"}]}],
       ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "relation", "]"}]}], "}"}]}], "]"}], "*", 
    "100", "*", "2.3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pairDist", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{"UnitConvert", "[", 
       RowBox[{
        RowBox[{"GeoDistance", "[", 
         RowBox[{
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"meanpos", "[", 
               RowBox[{"[", 
                RowBox[{"relation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"meanpos", "[", 
               RowBox[{"[", 
                RowBox[{"relation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"temp", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"meanpos", "[", 
               RowBox[{"[", 
                RowBox[{"relation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"meanpos", "[", 
               RowBox[{"[", 
                RowBox[{"relation", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], ",", 
        "\"\<Kilometers\>\""}], "]"}], "]"}], "*", "1000"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "relation", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mapRatio", "[", "dege_", "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"dege", ">", "40"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"32", "<", "dege", "<", "40"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dege", "-", "32"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"40", "-", "32"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"40", "-", "dege"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"40", "-", "32"}], ")"}]}]}], "}"}], ",", 
     RowBox[{"15", "<", "dege", "<", "32"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dege", "-", "15"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"32", "-", "15"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"32", "-", "dege"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"32", "-", "15"}], ")"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"dege", "<", "15"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HistogramList", "[", 
   RowBox[{"deg", ",", 
    RowBox[{"{", "5", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"repeat", "[", "rep_", "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Replace", "[", 
     RowBox[{"rep", ",", 
      RowBox[{"x_", "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{"x", ",", "x", ",", "x"}], "}"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mapdeg", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"mapRatio", "[", "#", "]"}], "&"}], "/@", 
   "deg"}]}], "\[IndentingNewLine]", 
 RowBox[{"Round", "[", 
  RowBox[{"mapdeg", "*", 
   RowBox[{"repeat", "[", "relationPair", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"val", "=", 
  RowBox[{"Total", "[", 
   RowBox[{"Round", "[", 
    RowBox[{"mapdeg", "*", 
     RowBox[{"repeat", "[", "relationPair", "]"}], "*", 
     RowBox[{"repeat", "[", "pairDist", "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N", "@", "val"}], "/", 
  RowBox[{"Total", "[", "val", "]"}]}]}], "Input",
 CellChangeTimes->{{3.719443468081526*^9, 3.719443468379595*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:7ebf\:6027\:56de\:5f52", "Subchapter",
 CellChangeTimes->{{3.7194436663610764`*^9, 3.719443682133174*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1109896", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1725342", ",", "30"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2080972", ",", "34"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"543987", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"896142", ",", "21"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1109896", ",", "27"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1725342", ",", "41"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2080972", ",", "38"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"543987", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"896142", ",", "21"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"model1", "=", 
  RowBox[{"LinearModelFit", "[", 
   RowBox[{"data", ",", "x", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"model2", "=", 
  RowBox[{"LinearModelFit", "[", 
   RowBox[{"data1", ",", "x", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"data", ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"model1", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "543987", ",", "4436798"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"data1", ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"model2", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "543987", ",", "4436798"}], "}"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<area\>\"", ",", "\"\<advanced line\>\""}], "}"}]}]}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ours", "=", "10327150"}], "\[IndentingNewLine]", 
 RowBox[{"model1", "[", "ours", "]"}], "\[IndentingNewLine]", 
 RowBox[{"model2", "[", "ours", "]"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:7ed8\:5236\:6d41\:7a0b\:56fe", "Subchapter",
 CellChangeTimes->{{3.719443522008471*^9, 3.7194435293655663`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"relation", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "9"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graph", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", "relation"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graph", "[", 
  RowBox[{"graph", ",", 
   RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}]}], "Input"]
}, Open  ]]
},
WindowSize->{720, 809},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (2016\:5e747\
\:670828\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 162, 2, 63, "Subchapter"],
Cell[745, 26, 5276, 157, 411, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6058, 188, 288, 5, 95, "Subchapter"],
Cell[6349, 195, 13374, 409, 902, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19760, 609, 203, 3, 63, "Subchapter"],
Cell[19966, 614, 1138, 34, 138, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21141, 653, 220, 2, 63, "Subchapter"],
Cell[21364, 657, 14864, 441, 1108, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36265, 1103, 114, 1, 63, "Subchapter"],
Cell[36382, 1106, 2210, 64, 285, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38629, 1175, 120, 1, 63, "Subchapter"],
Cell[38752, 1178, 1542, 49, 117, "Input"]
}, Open  ]]
}
]
*)

